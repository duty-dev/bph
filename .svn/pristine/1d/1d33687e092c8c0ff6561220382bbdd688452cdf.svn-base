<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:rabbit="http://www.springframework.org/schema/rabbit"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context.xsd
            http://www.springframework.org/schema/rabbit
                http://www.springframework.org/schema/rabbit/spring-rabbit-1.0.xsd">

	<rabbit:connection-factory id="connectionFactory"
		host="${rabbitmq.location}" port="${rabbitmq.port}" username="${rabbitmq.user}" password="${rabbitmq.password}" />

	<rabbit:admin connection-factory="connectionFactory" />
	
	<!--交换机，路由-->
	<rabbit:topic-exchange name="GpsTopicExchange" durable="false" auto-delete="false" id="GpsTopicExchange">
		<!-- 消费者使用 /510106000000/510106993600/510106993630 -->
		<rabbit:bindings><rabbit:binding queue="gpsQueue" pattern="*.#" /></rabbit:bindings>
		
	</rabbit:topic-exchange>
	
	<!--生产者使用-->
	<rabbit:template exchange="GpsTopicExchange" id="rabbitTemplate" connection-factory="connectionFactory" />
	
	
	<!--消费者使用 -->
	<bean id="consumeMessage" class="com.tianyi.bph.web.rabbitmq.Consumer" />
	<rabbit:listener-container connection-factory="connectionFactory" acknowledge="manual" prefetch="1">
		<rabbit:listener queues="gpsQueue" ref="consumeMessage" />
	</rabbit:listener-container>
	
	
	<!--队列，消费者使用 -->
	<rabbit:queue durable="true" auto-delete="true" exclusive="false" name="gpsQueue" id="gpsQueue" />
	
</beans>